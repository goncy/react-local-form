!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("react")):"function"==typeof define&&define.amd?define(["react"],r):e["react-local-form"]=r(e.React)}(this,function(r){"use strict";var l="default"in r?r.default:r;function i(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function n(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function t(e,r,t){return r&&n(e.prototype,r),t&&n(e,t),e}function f(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function c(){return(c=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function s(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},n=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.forEach(function(e){f(r,e,t[e])})}return r}function o(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&u(e,r)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,r){return(u=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e})(e,r)}function v(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},u=Object.keys(e);for(n=0;n<u.length;n++)t=u[n],0<=r.indexOf(t)||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(n=0;n<u.length;n++)t=u[n],0<=r.indexOf(t)||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}function y(e,r){return!r||"object"!=typeof r&&"function"!=typeof r?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):r}function a(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=[],n=!0,o=!1,u=void 0;try{for(var a,i=e[Symbol.iterator]();!(n=(a=i.next()).done)&&(t.push(a.value),!r||t.length!==r);n=!0);}catch(e){o=!0,u=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw u}}return t}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var e=l.createContext({}),d=e.Provider,b=e.Consumer,h=function(e,r){return e.map(function(e){return e(r)}).filter(Boolean)},m=function(e){return Object.entries(e).map(function(e){var r=a(e,2);return{field:r[0],errors:r[1]}}).filter(function(e){var r=e.errors;return Boolean(r.length)})},O=function(e){function u(){var e,r,f;i(this,u);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return y(f,(r=f=y(this,(e=p(u)).call.apply(e,[this].concat(n))),f.state={values:f.props.values||{},formErrors:[],fieldErrors:{}},f.onSubmit=function(e){var r=f.props,t=r.onSubmit,n=r.rules,o=f.state,u=o.fieldErrors,a=o.values;e.preventDefault();var i=m(u),l=h(n,a).flat();f.setState({formErrors:l}),t({values:a,fieldErrors:i,formErrors:l})},r))}return o(u,r.Component),t(u,[{key:"render",value:function(){var e=this.props,r=e.children,t=e.render,n=v(e,["children","render"]),o=this.state,u=o.values,a=o.fieldErrors,i=o.formErrors;return l.createElement(d,{value:{values:u,fieldErrors:a,setContext:this.setState.bind(this)}},l.createElement("form",c({},n,{onSubmit:this.onSubmit}),t?t({values:u,formErrors:i,fieldErrors:m(a)}):r))}}]),u}();O.defaultProps={rules:[]};var E,g=function(e){function a(){var e,r,u;i(this,a);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return y(u,(r=u=y(this,(e=p(a)).call.apply(e,[this].concat(n))),u.validate=function(r){var e=u.props,t=e.contextProps.setContext,n=e.rules,o=e.name;t(function(e){return{fieldErrors:s({},e.fieldErrors,f({},o,h(n,r)))}})},u.update=function(r){var e=u.props,t=e.contextProps.setContext,n=e.name;t(function(e){return{values:s({},e.values,f({},n,r))}})},r))}return o(a,r.Component),t(a,[{key:"componentDidMount",value:function(){var e=this.props,r=e.contextProps.values,t=e.validate,n=e.name;"always"===t&&this.validate(r[n])}},{key:"render",value:function(){var n=this,e=this.props,r=e.contextProps,t=r.values,o=r.fieldErrors,u=e.name,a=e.children;return l.cloneElement(a,{value:t[u],error:(o[u]||[])[0],onChange:function(e){var r,t=(r=e).target?r.target.value:r;n.validate(t),n.update(t),e.persist()}})}}]),a}();return g.defaultProps={rules:[],validate:"change"},{Form:O,FormItem:(E=g,function(r){return l.createElement(b,null,function(e){return l.createElement(E,c({contextProps:e},r))})})}});
